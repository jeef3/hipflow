<section class="sidebar" ng-controller="RoomCtrl">
  <div>Lobby</div>

  <ul class="room-list">
    <li class="room"
        ng-repeat="room in rooms | filter:{open:true}"
        ng-class="{'active': room.id === currentRoom}">
      <button type="button"
          class="room__join-btn"
          ng-click="showRoom(room.organization.parameterized_name + '/' + room.parameterized_name)">
        <i class="fa fa-fw fa-comments room__type-icon"></i>
        <span ng-bind="room.name"></span>
      </button>

      <button type="button"
          class="room__close-btn"
          ng-click="leaveRoom(room.organization.parameterized_name + '/' + room.parameterized_name)">
        <i class="fa fa-fw fa-times"></i>
      </button>
    </li>
  </ul>

  <ul class="room-list">
    <li class="room"
        ng-repeat="query in queries | filter:{open:true}"
        ng-click="show(query.id)"
        ng-class="{'query-online': query.online,
                   'query-offline': !query.online,
                   'active': query.id === currentRoom}">
      <button type="button"
          class="room__join-btn"
          ng-click="showRoom('private/' + query.id)">
        <i class="fa fa-fw room__type-icon"
            ng-class="{'fa-circle': query.online,
                       'fa-circle-o': !query.online}"></i>
        <span ng-bind="query.name"></span>
      </button>

      <button type="button"
          class="room__close-btn"
          ng-click="leaveRoom('private/' + query.id)">
        <i class="fa fa-fw fa-times"></i>
      </button>
    </li>
  </ul>
</section>

<section ng-controller="MessagesCtrl"
    ng-class="{'is-loading': isLoading}"
    class="chat">

  <div class="topic-bar">

  </div>

  <div class="messages-container">
    <ul class="messages">
      <li class="messages-loading">
        <i class="fa fa-fw fa-refresh fa-spin"></i>
      </li>
      <li class="message"
          ng-repeat="message in messages | orderBy:'sent'">
        <div ng-if="message.event === 'message'">
          <div class="message__user" ng-bind="users[message.user].nick"></div>
          <div class="message__content" ng-bind-html="message.content | codeFormat | messageLinks"></div>
          <div class="message__time" am-time-ago="message.sent"></div>
        </div>
      </li>
    </ul>
  </div>

  <div class="chat-bar">
    <form ng-submit="send(message)">
      <input type="text" ng-model="message">
      <button type="submit" class="btn">Send</button>
    </form>
  </div>
</section>

<aside class="chat-context" ng="ChatContextCtrl">

</aside>
