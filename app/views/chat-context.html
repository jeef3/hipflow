<aside class="chat-context" ng-controller="ChatContextCtrl">

  <ul class="users">
    <li class="user avatar"
        style="background-image:url({{user.avatar}})"
        title="{{user.name}}"
        ng-repeat="user in currentRoom.users | orderBy:'-last_ping'"
        ng-class="{'user-online': isOnline(user),
                   'user-offline': !isOnline(user)}">
    </li>
  </ul>

  <!-- <h3 class="small-title">Discussions</h3> -->
  <ul class="discussion-list">
    <li class="discussion-list__item"
        ng-repeat="discussion in flowdock.discussions[currentRoom.id] | orderBy:'-lastUpdate'"
        ng-class="{'discussion-muted': discussion.muted}"
        ng-click="discussion.muted = !discussion.muted">
      <i class="fa fa-fw"
          ng-class="{'fa-volume-up': !discussion.muted,
                     'fa-volume-off': discussion.muted}"></i>
      <span ng-if="discussion.event === 'file'"
          title="{{discussion.content.file_name}}">{{discussion.content.file_name}}</span>
      <span ng-if="discussion.event === 'message'"
          title="{{discussion.content}}">{{discussion.content}}</span>
    </li>
  </ul>

  <buton type="button"
      class="btn refresh-token-btn"
      ng-click="refreshToken()"
      ng-class="{'is-expired': tokenExpired,
                 'has-refresh-error': authError}">Refresh Token</buton>

</aside>
